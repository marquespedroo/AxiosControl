# MCMI-IV - PLANO DE IMPLEMENTA√á√ÉO COMPLETO

## üìã VIS√ÉO GERAL

**Nome do Teste**: MCMI-IV (Invent√°rio Cl√≠nico Multiaxial de Millon - 4¬™ Edi√ß√£o)
**Idioma Original**: Espanhol
**Idioma Alvo**: Portugu√™s Brasileiro
**Total de Itens**: 195 quest√µes
**Formato de Resposta**: Verdadeiro/Falso
**Total de Escalas**: 64 escalas (5 validade + 14 personalidade + 3 patologia grave + 11 s√≠ndromes cl√≠nicas + 24 facetas Grossman + 13 respostas significativas)

---

## üéØ ESTRUTURA DO TESTE

### 1. ESCALAS DE VALIDADE (5 escalas)

| C√≥digo | Nome (ES) | Nome (PT-BR) | Descri√ß√£o |
|--------|-----------|--------------|-----------|
| V | Invalidez | Invalidez | Detecta perfis inv√°lidos por respostas aleat√≥rias ou confusas |
| W | Inconsistencia | Inconsist√™ncia | Mede padr√µes de resposta inconsistentes |
| X | Sinceridad | Sinceridade | Avalia abertura e honestidade nas respostas |
| Y | Deseabilidad Social | Desejabilidade Social | Tend√™ncia a parecer socialmente desej√°vel |
| Z | Devaluaci√≥n | Desvaloriza√ß√£o | Tend√™ncia a menosprezar-se ou exagerar problemas |

**Crit√©rios de Validade**:
- V = 0 ou 1: V√°lido
- V = 2: Duvidoso
- V ‚â• 3: Inv√°lido
- W > 18: Inv√°lido (respostas aleat√≥rias)
- X < 6 ou X > 113: Inv√°lido

### 2. PADR√ïES DE PERSONALIDADE (14 escalas)

| C√≥digo | Nome (ES) | Nome (PT-BR) |
|--------|-----------|--------------|
| 1 | Esquizoide | Esquizoide |
| 2A | Evitativo | Evitativo |
| 2B | Melanc√≥lico | Melanc√≥lico |
| 3 | Dependiente | Dependente |
| 4A | Histri√≥nico | Histri√¥nico |
| 4B | Tempestuoso | Tempestuoso |
| 5 | Narcisista | Narcisista |
| 6A | Antisocial | Antissocial |
| 6B | S√°dico | S√°dico |
| 7 | Compulsivo | Compulsivo |
| 8A | Negativista | Negativista |
| 8B | Masoquista | Masoquista |

### 3. PATOLOGIAS GRAVES DE PERSONALIDADE (3 escalas)

| C√≥digo | Nome (ES) | Nome (PT-BR) |
|--------|-----------|--------------|
| S | Esquizot√≠pico | Esquizot√≠pico |
| C | L√≠mite | Borderline/Lim√≠trofe |
| P | Paranoide | Paranoide |

### 4. S√çNDROMES CL√çNICAS (11 escalas)

| C√≥digo | Nome (ES) | Nome (PT-BR) |
|--------|-----------|--------------|
| A | Trastorno por Ansiedad | Transtorno de Ansiedade |
| H | Trastorno Som√°tico | Transtorno Som√°tico |
| N | Espectro B√≠polar | Espectro Bipolar |
| D | Depresi√≥n Persistente | Depress√£o Persistente |
| B | Consumo de Alcohol | Consumo de √Ålcool |
| T | Consumo de Drogas | Consumo de Drogas |
| R | Estr√©s Postraum√°tico | Estresse P√≥s-Traum√°tico |
| SS | Espectro Esquizofr√©nico | Espectro Esquizofr√™nico |
| CC | Depresi√≥n Mayor | Depress√£o Maior |
| PP | Delirante | Delirante |

### 5. FACETAS DE GROSSMAN (24 sub-escalas)

Cada escala de personalidade principal tem 3 facetas que detalham aspectos espec√≠ficos:

**Escala 1 - Esquizoide**:
- 1.1: Interpersonalmente Ap√°tico
- 1.2: Conte√∫do Escasso
- 1.3: Temperamentalmente Ap√°tico

**Escala 2A - Evitativo**:
- 2A.1: Interpersonalmente Aversivo
- 2A.2: Autoimagem Alienada
- 2A.3: Conte√∫do Vexat√≥rio

**Escala 2B - Melanc√≥lico**:
- 2B.1: Cognitivamente Fatalista
- 2B.2: Autoimagem In√∫til
- 2B.3: Temperamentalmente Aflito

**Escala 3 - Dependente**:
- 3.1: Expressivamente Pueril
- 3.2: Interpersonalmente Submisso
- 3.3: Autoimagem Inepta

**Escala 4A - Histri√¥nico**:
- 4A.1: Expressivamente Dram√°tico
- 4A.2: Interpersonalmente Busca Aten√ß√£o
- 4A.3: Temperamentalmente Inconstante

**Escala 4B - Tempestuoso**:
- 4B.1: Expressivamente Impetuoso
- 4B.2: Interpersonalmente Euf√≥rico
- 4B.3: Autoimagem Superestimada

**Escala 5 - Narcisista**:
- 5.1: Interpersonalmente Explorador
- 5.2: Autoimagem Admir√°vel
- 5.3: Din√¢micas de Expans√£o

**Escala 6A - Antissocial**:
- 6A.1: Interpersonalmente Irrespons√°vel
- 6A.2: Autoimagem Aut√¥noma
- 6A.3: Din√¢micas de Irreflex√£o

**Escala 6B - S√°dico**:
- 6B.1: Expressivamente Precipitado
- 6B.2: Interpersonalmente Desagrad√°vel
- 6B.3: Arquitetura Eruptiva

**Escala 7 - Compulsivo**:
- 7.1: Expressivamente Disciplinado
- 7.2: Interpersonalmente Respeitoso
- 7.3: Autoimagem Consciente

**Escala 8A - Negativista**:
- 8A.1: Expressivamente Ressentido
- 8A.2: Autoimagem Descontente
- 8A.3: Temperamentalmente Irrit√°vel

**Escala 8B - Masoquista**:
- 8B.1: Autoimagem Desmerecedora
- 8B.2: Arquitetura Invertida
- 8B.3: Temperamentalmente Disf√≥rico

### 6. RESPOSTAS SIGNIFICATIVAS (13 categorias)

| # | Nome (ES) | Nome (PT-BR) | Itens |
|---|-----------|--------------|-------|
| 1 | TDAH | TDAH | 6 |
| 2 | Espectro Autista | Espectro Autista | 7 |
| 3 | Maltrato Infantil | Maus-Tratos na Inf√¢ncia | 2 |
| 4 | Trastornos de la conducta alimentaria | Transtornos Alimentares | 4 |
| 5 | Falta de Control Emocional | Falta de Controle Emocional | 8 |
| 6 | Explosiones de Ira | Explos√µes de Raiva | 6 |
| 7 | Preocupaci√≥n por su salud | Preocupa√ß√£o com a Sa√∫de | 6 |
| 8 | Alienaci√≥n Interpersonal | Aliena√ß√£o Interpessoal | 4 |
| 9 | Abuso de Medicaci√≥n | Abuso de Medica√ß√£o | 2 |
| 10 | Potencial Conducta autodestructiva | Potencial Conduta Autodestrutiva | 12 |
| 11 | Conductas/Tendencias Autolesivas | Condutas/Tend√™ncias Autolesivas | 2 |
| 12 | Lesi√≥n Cerebral | Les√£o Cerebral | 2 |
| 13 | Tendencias Vengativas | Tend√™ncias Vingativas | 8 |

---

## ‚öôÔ∏è SISTEMA DE PONTUA√á√ÉO

### Etapa 1: Pontua√ß√£o Bruta (PD - Puntuaci√≥n Directa)

**M√©todo**: F√≥rmulas ponderadas

Cada escala possui uma f√≥rmula espec√≠fica que calcula a pontua√ß√£o bruta baseada nas respostas aos itens.

**Estrutura da F√≥rmula**:
```
PD = (2 * (item_peso2_1 + item_peso2_2 + ... + item_peso2_n)) +
     (item_peso1_1 + item_peso1_2 + ... + item_peso1_m)
```

**Exemplo - Escala 1 (Esquizoide)**:
```
PD_Escala1 = (2*(D18+D27+D55+D102+D131+D151+D161+D192)) +
             (D29+D36+D42+D82+D104+E166+D202)
```

Onde:
- D/E = coluna (D=Verdadeiro, E=Falso)
- N√∫mero = item/quest√£o
- Itens multiplicados por 2 = peso duplo
- Itens somados diretamente = peso simples

**TODAS AS F√ìRMULAS NECESS√ÅRIAS**:

```typescript
// ESCALAS DE VALIDADE
V_Invalidez = APLICACION!F46
W_Inconsistencia = APLICACION!K60
X_Sinceridad = APLICACION!G63
Y_Deseabilidade = APLICACION!G64
Z_Desvalorizacao = APLICACION!G65

// PADR√ïES DE PERSONALIDADE
Escala_1_Esquizoide = (2*(D18+D27+D55+D102+D131+D151+D161+D192)) + (D29+D36+D42+D82+D104+E166+D202)

Escala_2A_Evitativo = (2*(D17+D24+D38+D111+D147+D207)) + (D35+D36+D58+D64+E79+D104+D105+D124+E166+D190+D196+D205)

Escala_2B_Melancolico = (2*(D35+D63+D83+D105+D123+D181+D187+D196+D205)) + (D29+D34+D51+E65+D71+D82+D102+D138+D182+D190)

Escala_3_Dependente = (2*(D16+D54+D72+D89+D121+D145+D174+D185+D206)) + (D17+D35+E79+D84+D187)

Escala_4A_Histrionico = (2*(D22+D42+D58+D96+D129+D166+D183)) + (E18+D20+E27+E36+E38+D87+E151+D167+E190+E207)

Escala_4B_Tempestuoso = (2*(D20+D32+D65+D87+D141+D167+D186+D197)) + (E38+D42+D58+D79+D96+E132+D154+D166+D190)

Escala_5_Narcisista = (2*(D41+D50+D66+D79+D99+D118+D144+D154+D171+D201)) + (D22+D31+D95+D129+D183+D203)

Escala_6A_Antissocial = (2*(D23+D31+D77+D95+D159+D195+D203)) + (D48+D50+E60+D117+D164+E170+D171)

Escala_6B_Sadico = (2*(D21+D62+D78+D109+D115+D127+D153+D164)) + (D23+D28+D33+D86+D157+D184)

Escala_7_Compulsivo = (2*(D14+D47+D60+D75+D85+D140+D152+D170+D191+D200)) + (E95+E159+E164)

Escala_8A_Negativista = (2*(D29+D44+D94+D108+D134+D149+D179+D199)) + (D33+D49+D64+D91+D100+D109+D112+D180+D184+D196)

Escala_8B_Masoquista = (2*(D51+D71+D97+D112+D138+D178+D204)) + (D16+D24+E32+D35+D82+E87+D105+D168+D176+D190+D207)

// PATOLOGIAS GRAVES
Escala_S_Esquizotipico = (2*(D45+D84+D101+D125+D135+D155)) + (D43+D53+D56+D63+D103+D120+D121)

Escala_C_Limite = (2*(D19+D40+D53+D132+D158)) + (D13+E32+D69+D125+D130)

Escala_P_Paranoide = (2*(D15+D39+D68+D120+D175+D189)) + (D49+D62+D66+D94+D95+D117+D167)

// S√çNDROMES CL√çNICAS
Escala_A_Ansiedade = (2*(D26+D46+D76+D130+D163+D182)) + (D29+D40+D51+D63+D83+E87+D89+D97+D105+D113+D123+D126+D132+D190+D205)

Escala_H_Somatico = (2*(D37+D57+D106+D142+D173)) + (D77+D95+D138)

Escala_N_Bipolar = (2*(D22+D32+D41+D65+D79+D87+D96+D129+D141+D166+D183+D186+D197)) + (D20+D44+D154+D167)

Escala_D_Depressao_Persistente = (2*(D25+D36+D56+D104+D124+D168+D177+D202)) + (D30+D70+D82+D102+D105+D133+D135+D138+D160+D175+D179+D184+D207)

Escala_B_Alcool = (2*(D28+D30+D49+D82+D146+D176+D190)) + (D16+D71+D92+D94+D105+D112+D123+D138+D149+D168+D178+D204+D205)

Escala_T_Drogas = (2*(D33+D64+D91+D100+D116+D148+D165+D184)) + (D25+D36+D80+D108+D160+D179+D192+D207)

Escala_R_PosTraumatico = (2*(D34+D67+D88+D107+D119+D137+D143+D156+D162+D169+D172+D180)) + (D25+D30+D36+D49+D63+D70+D82+D83+D104+D123+D133+D160+D176+D179+D187+D202+D205)

Escala_SS_Esquizofrenico = (2*(D13+D45+D61+D84+D90+D101+D110+D125+D135+D155)) + (D40+D43+D56+D63+D93+D120+D122+D126)

Escala_CC_Depressao_Maior = (2*(D25+D35+D56+D63+D70+D104+D105+D124+D133+D168+D177+D179+D202+D205)) + (D29+D36+D71+D82+D97+D102+D123+D138+D160+D175+D181+D196+D204)

Escala_PP_Delirante = (2*(D13+D39+D61+D74+D90+D93+D110+D122+D136+D188)) + (D45+D84+D120)
```

### Etapa 2: Convers√£o para Taxa de Base (BR/PE)

**M√©todo**: Tabelas de Convers√£o (VLOOKUP)

Cada pontua√ß√£o bruta (PD) √© convertida para uma Taxa de Base (BR) ou Estimativa de Preval√™ncia (PE) usando tabelas normativas espec√≠ficas.

**Tabelas Necess√°rias**:
- `PUNT-DIRECTA`: Tabela PD ‚Üí BR
- `PERCENTIL`: Tabela BR ‚Üí Percentil
- `PERCENTIL2`: Tabela alternativa
- `PERCENTIL GROSSMAN`: Tabela para facetas de Grossman

**F√≥rmula de Convers√£o**:
```
BR = VLOOKUP(PD, TABELA_PD_BR, coluna_escala, FALSE)
Percentil = VLOOKUP(BR, TABELA_BR_PERCENTIL, coluna_escala, FALSE)
```

### Etapa 3: Interpreta√ß√£o Autom√°tica

**Faixas de Interpreta√ß√£o** (baseadas em BR):

| BR | Classifica√ß√£o | Descri√ß√£o (PT-BR) |
|----|---------------|-------------------|
| < 60 | N√£o Apresenta | Caracter√≠sticas n√£o presentes ou m√≠nimas |
| 60-74 | Categoria de Risco | Tra√ßos presentes, mas n√£o dominantes |
| 75-84 | Padr√µes Menos Adaptativos e Transtornos | Tra√ßos proeminentes e clinicamente significativos |
| ‚â• 85 | Transtornos Cr√≠ticos | Padr√µes extremamente pronunciados, requerem aten√ß√£o imediata |

**L√≥gica de Interpreta√ß√£o** (exemplo):
```typescript
function interpretarEscala(BR: number): string {
  if (BR < 60) return "N√£o Apresenta"
  if (BR < 75) return "Categoria de Risco"
  if (BR < 85) return "Padr√µes Menos Adaptativos e Transtornos"
  return "Transtornos Cr√≠ticos"
}
```

---

## üìä VISUALIZA√á√ïES REQUERIDAS

### 1. Gr√°fico de Perfil de Personalidade

**Tipo**: Gr√°fico de Barras Horizontais

**Eixo X**: Taxa de Base (BR) - Escala de 0 a 100
**Eixo Y**: Escalas de Personalidade (14 escalas)

**Zonas de Cores**:
- 0-59: Verde (Normal)
- 60-74: Amarelo (Risco)
- 75-84: Laranja (Padr√£o)
- 85-100: Vermelho (Cr√≠tico)

**Linhas de Refer√™ncia**:
- Linha vertical em 60 (in√≠cio de risco)
- Linha vertical em 75 (padr√£o cl√≠nico)
- Linha vertical em 85 (cr√≠tico)

### 2. Gr√°fico de Facetas de Grossman

**Tipo**: Gr√°fico de Barras Agrupadas

Para cada escala de personalidade elevada (BR ‚â• 60), mostrar as 3 facetas correspondentes.

**Formato**:
- Agrupamento por escala principal
- 3 barras por grupo (uma para cada faceta)
- Percentis de 0-100

### 3. Indicadores de Respostas Significativas

**Tipo**: Badges/Pills coloridos

**Formato**:
- Nome da categoria
- Pontua√ß√£o (n√∫mero de respostas positivas)
- Percentual (pontua√ß√£o / total de itens * 100)

**Crit√©rio de Exibi√ß√£o**:
- Mostrar apenas categorias com ‚â• 1 resposta positiva
- Destacar em vermelho se percentual > 50%

### 4. Gr√°fico de V√°lidade

**Tipo**: Gauge/Medidor ou Sem√°foro

**Escalas**:
- V (Invalidez): 0-1 Verde | 2 Amarelo | 3+ Vermelho
- W (Inconsist√™ncia): 0-18 Verde | 19+ Vermelho
- X (Sinceridade): 6-113 Verde | Fora = Vermelho
- Y (Desejabilidade): Gradiente 0-100
- Z (Desvaloriza√ß√£o): Gradiente 0-100

### 5. Relat√≥rio de Interpreta√ß√£o Textual

**Componentes**:
1. **Resumo de Validade**: Status geral do protocolo
2. **Padr√µes de Personalidade Dominantes**: Lista de escalas BR ‚â• 75
3. **Patologias Graves**: Se alguma BR ‚â• 75
4. **S√≠ndromes Cl√≠nicas Ativas**: Lista de s√≠ndromes BR ‚â• 60
5. **Facetas Destacadas**: Facetas de Grossman com percentil ‚â• 70
6. **Respostas Significativas**: Alertas para categorias com ‚â• 2 respostas

---

## üóÑÔ∏è ESQUEMA DE BANCO DE DADOS

### Altera√ß√µes na Tabela `testes_templates`

```sql
-- Adicionar campos espec√≠ficos para MCMI-IV
ALTER TABLE testes_templates ADD COLUMN IF NOT EXISTS
  tem_pesos BOOLEAN DEFAULT FALSE,
  tem_formulas BOOLEAN DEFAULT FALSE,
  tem_tabelas_conversao BOOLEAN DEFAULT FALSE,
  tabelas_conversao JSONB;
```

### Estrutura do Campo `questoes` para MCMI-IV

```json
{
  "questoes": [
    {
      "numero": 1,
      "texto": "Ultimamente parece que fico sem for√ßas at√© pela manh√£.",
      "tipo": "verdadeiro_falso",
      "pesos": {
        "1": {  // Escala 1
          "verdadeiro": 2,  // Peso se responder V
          "falso": 0
        },
        "2A": {  // Escala 2A
          "verdadeiro": 0,
          "falso": 1  // Peso se responder F
        }
        // ... outros pesos para outras escalas
      }
    }
    // ... 194 quest√µes mais
  ]
}
```

### Estrutura do Campo `regras_calculo` para MCMI-IV

```json
{
  "escalas": {
    "validade": [
      {
        "codigo": "V",
        "nome": "Invalidez",
        "formula": "ESPECIAL_V",  // Fun√ß√£o especial
        "interpretacao": {
          "0-1": "V√°lido",
          "2": "Duvidoso",
          "3+": "Inv√°lido"
        }
      }
      // ... outras escalas de validade
    ],
    "personalidade": [
      {
        "codigo": "1",
        "nome": "Esquizoide",
        "itens_peso2": [18, 27, 55, 102, 131, 151, 161, 192],
        "itens_peso1_verdadeiro": [29, 36, 42, 82, 104, 202],
        "itens_peso1_falso": [166],
        "facetas": [
          {
            "codigo": "1.1",
            "nome": "Interpersonalmente Ap√°tico",
            "itens_verdadeiro": [24, 27, 36, 116, 161, 166, 192, 197, 202]
          }
          // ... mais facetas
        ]
      }
      // ... outras escalas de personalidade
    ],
    "patologia_grave": [...],
    "sindromes_clinicas": [...],
    "respostas_significativas": [
      {
        "codigo": "RS1",
        "nome": "TDAH",
        "itens": [68, 75, 89, 94, 104, 120],
        "total_itens": 6
      }
      // ... outras respostas significativas
    ]
  },
  "tabelas_conversao": {
    "PD_para_BR": {
      "escala_1": {
        "0": 0,
        "1": 5,
        "2": 10,
        // ... tabela completa
      }
      // ... outras escalas
    },
    "BR_para_Percentil": {
      "escala_1": {
        "0": 1,
        "5": 2,
        // ... tabela completa
      }
    },
    "Grossman_PD_para_Percentil": {
      "1.1": {
        "0": 0,
        "1": 20,
        // ... tabela completa
      }
    }
  }
}
```

### Estrutura do Campo `respostas` (testes_aplicados)

```json
{
  "1": 1,  // Item 1: Verdadeiro (1) ou Falso (0)
  "2": 0,
  "3": 1,
  // ... at√© 195
}
```

### Estrutura do Campo `pontuacao_bruta` (testes_aplicados)

```json
{
  "validade": {
    "V": 1,
    "W": 7,
    "X": 26,
    "Y": 18,
    "Z": 4
  },
  "personalidade": {
    "1": 6,
    "2A": 1,
    "2B": 6,
    "3": 6,
    "4A": 15,
    "4B": 22,
    "5": 6,
    "6A": 1,
    "6B": 1,
    "7": 13,
    "8A": 9,
    "8B": 5
  },
  "patologia_grave": {
    "S": 2,
    "C": 0,
    "P": 3
  },
  "sindromes_clinicas": {
    "A": 6,
    "H": 0,
    "N": 20,
    "D": 2,
    "B": 6,
    "T": 9,
    "R": 9,
    "SS": 2,
    "CC": 2,
    "PP": 0
  },
  "facetas_grossman": {
    "1.1": 1,
    "1.2": 2,
    "1.3": 3,
    // ... todas as 24 facetas
  },
  "respostas_significativas": {
    "RS1": 2,  // TDAH: 2 de 6 itens
    "RS2": 0,  // Espectro Autista: 0 de 7
    "RS3": 2,  // Maus-tratos: 2 de 2
    // ... todas as 13 categorias
  }
}
```

### Estrutura do Campo `normalizacao` (testes_aplicados)

```json
{
  "taxa_base": {
    "validade": {
      "V": 1,
      "W": 7,
      "X": 30,
      "Y": 78,
      "Z": 37
    },
    "personalidade": {
      "1": 40,  // BR/PE
      "2A": 6,
      "2B": 30,
      "3": 36,
      "4A": 75,
      "4B": 80,
      "5": 62,
      "6A": 20,
      "6B": 10,
      "7": 49,
      "8A": 60,
      "8B": 38
    },
    "patologia_grave": {
      "S": 12,
      "C": 45,
      "P": 66
    },
    "sindromes_clinicas": {
      "A": 30,
      "H": 0,
      "N": 68,
      "D": 20,
      "B": 35,
      "T": 50,
      "R": 42,
      "SS": 8,
      "CC": 18,
      "PP": 0
    }
  },
  "percentis": {
    "personalidade": {
      "1": 31,
      "2A": 5,
      "2B": 28,
      "3": 25,
      "4A": 83,
      "4B": 93,
      "5": 56,
      "6A": 25,
      "6B": 13,
      "7": 26,
      "8A": 48,
      "8B": 33
    },
    "patologia_grave": {
      "S": 14,
      "C": 40,
      "P": 62
    },
    "sindromes_clinicas": {
      "A": 30,
      "H": 0,
      "N": 75,
      "D": 20,
      "B": 35,
      "T": 50,
      "R": 40,
      "SS": 10,
      "CC": 18,
      "PP": 0
    },
    "facetas_grossman": {
      "1.1": 20,
      "1.2": 30,
      "1.3": 60,
      // ... todas as facetas
    }
  },
  "percentuais_respostas_significativas": {
    "RS1": 33,  // 2/6 = 33%
    "RS2": 0,
    "RS3": 100,  // 2/2 = 100%
    // ...
  }
}
```

### Estrutura do Campo `interpretacao` (testes_aplicados)

```json
{
  "validade": {
    "status": "v√°lido",  // v√°lido | duvidoso | inv√°lido
    "V": "V√°lido",
    "W": "Consistente",
    "X": "Clinicamente interpret√°vel",
    "Y": "Tend√™ncia a parecer socialmente agrad√°vel...",
    "Z": "Tend√™ncia a menosprezar-se..."
  },
  "padroes_dominantes": [
    {
      "codigo": "4B",
      "nome": "Tempestuoso",
      "BR": 80,
      "nivel": "Padr√µes Menos Adaptativos e Transtornos",
      "descricao": "Os sujeitos tempestuosos s√£o muito alegres e animados..."
    },
    {
      "codigo": "4A",
      "nome": "Histri√¥nico",
      "BR": 75,
      "nivel": "Padr√µes Menos Adaptativos e Transtornos",
      "descricao": "Os sujeitos histri√¥nicos..."
    }
  ],
  "patologias_graves": [],  // Se BR ‚â• 75
  "sindromes_ativas": [
    {
      "codigo": "N",
      "nome": "Espectro Bipolar",
      "BR": 68,
      "nivel": "Categoria de Risco"
    }
  ],
  "facetas_destacadas": [
    {
      "codigo": "4B.2",
      "nome": "Interpersonalmente Euf√≥rico",
      "percentil": 93,
      "escala_pai": "4B"
    },
    {
      "codigo": "4B.3",
      "nome": "Autoimagem Superestimada",
      "percentil": 85,
      "escala_pai": "4B"
    }
  ],
  "respostas_significativas_alertas": [
    {
      "codigo": "RS3",
      "nome": "Maus-Tratos na Inf√¢ncia",
      "pontuacao": 2,
      "total": 2,
      "percentual": 100,
      "nivel_alerta": "alto"  // alto se ‚â• 50%, moderado se ‚â• 25%
    },
    {
      "codigo": "RS1",
      "nome": "TDAH",
      "pontuacao": 2,
      "total": 6,
      "percentual": 33,
      "nivel_alerta": "moderado"
    }
  ]
}
```

---

## üîß REQUISITOS T√âCNICOS

### Backend (API)

#### 1. Endpoint de C√°lculo

**POST** `/api/testes-aplicados/[id]/calcular`

**Fun√ß√£o**: Calcular todas as pontua√ß√µes para um teste MCMI-IV aplicado

**Etapas**:
1. Validar que todas as 195 quest√µes foram respondidas
2. Calcular pontua√ß√µes brutas usando as f√≥rmulas ponderadas
3. Converter PD ‚Üí BR usando tabelas de convers√£o
4. Converter BR ‚Üí Percentil usando tabelas de convers√£o
5. Gerar interpreta√ß√£o autom√°tica baseada em faixas de BR
6. Salvar tudo em `pontuacao_bruta`, `normalizacao`, `interpretacao`

**Pseudo-c√≥digo**:
```typescript
async function calcularMCMIIV(testeAplicadoId: string) {
  // 1. Buscar teste e respostas
  const teste = await getTeste Aplicado(testeAplicadoId)
  const template = await getTemplate(teste.teste_template_id)
  const respostas = teste.respostas

  // 2. Calcular PD para cada escala
  const pontuacaoBruta = {
    validade: calcularEscalasValidade(respostas, template),
    personalidade: calcularEscalasPersonalidade(respostas, template),
    patologia_grave: calcularPatologiasGraves(respostas, template),
    sindromes_clinicas: calcularSindromesClinicas(respostas, template),
    facetas_grossman: calcularFacetasGrossman(respostas, template),
    respostas_significativas: calcularRespostasSignificativas(respostas, template)
  }

  // 3. Converter PD ‚Üí BR
  const taxaBase = converterPDparaBR(pontuacaoBruta, template.regras_calculo.tabelas_conversao)

  // 4. Converter BR ‚Üí Percentil
  const percentis = converterBRparaPercentil(taxaBase, template.regras_calculo.tabelas_conversao)

  // 5. Gerar interpreta√ß√£o
  const interpretacao = gerarInterpretacao(taxaBase, pontuacaoBruta)

  // 6. Salvar
  await updateTeste({
    pontuacao_bruta,
    normalizacao: { taxa_base: taxaBase, percentis },
    interpretacao
  })
}
```

#### 2. Fun√ß√µes de C√°lculo

**calcularEscalasValidade**:
```typescript
function calcularEscalasValidade(respostas: Record<number, number>, template: any) {
  // V - Invalidez (itens espec√≠ficos que devem ser 1 ou 0)
  const V = calcularInvalidez(respostas)

  // W - Inconsist√™ncia (pares de itens contradit√≥rios)
  const W = calcularInconsistencia(respostas)

  // X, Y, Z - Usar f√≥rmulas do template
  const X = calcularComFormula(respostas, template.regras_calculo.escalas.validade.find(e => e.codigo === 'X'))
  const Y = calcularComFormula(respostas, template.regras_calculo.escalas.validade.find(e => e.codigo === 'Y'))
  const Z = calcularComFormula(respostas, template.regras_calculo.escalas.validade.find(e => e.codigo === 'Z'))

  return { V, W, X, Y, Z }
}
```

**calcularEscalasPersonalidade**:
```typescript
function calcularEscalasPersonalidade(respostas: Record<number, number>, template: any) {
  const escalas = template.regras_calculo.escalas.personalidade
  const resultado: Record<string, number> = {}

  for (const escala of escalas) {
    let PD = 0

    // Itens com peso 2
    for (const item of escala.itens_peso2) {
      if (respostas[item] === 1) PD += 2
    }

    // Itens com peso 1 (verdadeiro)
    for (const item of escala.itens_peso1_verdadeiro || []) {
      if (respostas[item] === 1) PD += 1
    }

    // Itens com peso 1 (falso)
    for (const item of escala.itens_peso1_falso || []) {
      if (respostas[item] === 0) PD += 1
    }

    resultado[escala.codigo] = PD
  }

  return resultado
}
```

**converterPDparaBR**:
```typescript
function converterPDparaBR(pontuacaoBruta: any, tabelasConversao: any) {
  const resultado: any = {}

  // Para cada categoria de escalas
  for (const [categoria, escalas] of Object.entries(pontuacaoBruta)) {
    resultado[categoria] = {}

    for (const [codigo, PD] of Object.entries(escalas as any)) {
      const tabelaEscala = tabelasConversao.PD_para_BR[`escala_${codigo}`]

      if (tabelaEscala) {
        // Buscar o BR correspondente ao PD
        resultado[categoria][codigo] = tabelaEscala[PD] || 0
      }
    }
  }

  return resultado
}
```

### Frontend (Components)

#### 1. Componente de Aplica√ß√£o do Teste

```tsx
<MCMITestApplication
  teste={testeData}
  onSave={(respostas) => saveProgress(respostas)}
  onFinalize={(respostas) => finalizarECalcular(respostas)}
/>
```

**Recursos**:
- 195 quest√µes Verdadeiro/Falso
- Navega√ß√£o quest√£o por quest√£o
- Barra de progresso (195 itens)
- Salvamento autom√°tico
- Contador de respostas

#### 2. Componente de Resultados

```tsx
<MCMIResults
  teste={testeData}
  interpretacao={teste.interpretacao}
  normalizacao={teste.normalizacao}
  pontuacaoBruta={teste.pontuacao_bruta}
/>
```

**Sub-componentes**:
- `<ValidityScales />` - Gr√°ficos de validade
- `<PersonalityProfile />` - Gr√°fico de barras do perfil
- `<GrossmanFacets />` - Gr√°ficos de facetas
- `<ClinicalSyndromes />` - Lista de s√≠ndromes ativas
- `<SignificantResponses />` - Badges de respostas significativas
- `<InterpretationReport />` - Texto interpretativo completo

#### 3. Componente de Gr√°fico de Perfil

```tsx
<ProfileChart
  data={normalizacao.taxa_base.personalidade}
  type="personality"
  thresholds={[60, 75, 85]}
/>
```

**Biblioteca**: Recharts ou Chart.js

**Configura√ß√£o**:
- Barras horizontais
- Cores por zona (verde/amarelo/laranja/vermelho)
- Linhas de refer√™ncia em 60, 75, 85
- Labels com nome da escala e valor BR

---

## üìù TRADU√á√ÉO PORTUGU√äS-BRASILEIRO

### Instru√ß√µes do Teste

**Espanhol**:
```
Instrucciones:
La persona deber√° responder las afirmaciones con una "1" en la casilla correspondiente.
Elegir√° la opci√≥n de "Verdadero" casilla izquierda.
Elegir√° la opci√≥n de "Falso" casilla derecha.
Trate de marcar cada frase a√∫n cuando no est√° seguro de su decisi√≥n.
Si ha intentado y todav√≠a no se puede decidir, marque el Falso.
Procure no hacer dobles respuestas.
```

**Portugu√™s BR**:
```
Instru√ß√µes:
A pessoa dever√° responder √†s afirma√ß√µes marcando "Verdadeiro" ou "Falso".
Escolha a op√ß√£o "Verdadeiro" se a afirma√ß√£o descreve voc√™ na maioria das vezes.
Escolha a op√ß√£o "Falso" se a afirma√ß√£o n√£o descreve voc√™ ou descreve raramente.
Tente marcar cada frase mesmo quando n√£o tiver certeza da sua decis√£o.
Se voc√™ tentou e ainda n√£o consegue decidir, marque "Falso".
Procure n√£o deixar nenhuma quest√£o sem resposta e n√£o marque as duas op√ß√µes.
```

### Primeiros 20 Itens Traduzidos

| # | Espanhol | Portugu√™s BR |
|---|----------|--------------|
| 1 | Ultimamente parece que me quedo sin fuerzas incluso por las ma√±anas. | Ultimamente parece que fico sem for√ßas at√© pela manh√£. |
| 2 | Siempre me aseguro de que mi trabajo est√© bien planeado y organizado. | Sempre me certifico de que meu trabalho esteja bem planejado e organizado. |
| 3 | Disfruto haciendo tantas cosas diferentes que no puedo decidir por cu√°l empezar. | Gosto de fazer tantas coisas diferentes que n√£o consigo decidir por qual come√ßar. |
| 4 | Me preocupa que las personas de las que dependo me abandonen. | Preocupa-me que as pessoas das quais dependo me abandonem. |
| 5 | Aunque me da miedo hacer amistades, me gustar√≠a tener m√°s de las que tengo. | Embora tenha medo de fazer amizades, gostaria de ter mais do que tenho. |
| 6 | Raramente exteriorizo los pocos sentimientos que tengo. | Raramente exteriorizo os poucos sentimentos que tenho. |
| 7 | Me cuesta mantener el equilibrio cuando camino. | Tenho dificuldade em manter o equil√≠brio quando caminho. |
| 8 | Siempre busco oportunidades nuevas que me resulten emocionantes. | Sempre busco oportunidades novas que sejam emocionantes para mim. |
| 9 | Algunas veces puedo ser bastante duro y desagradable con mi familia | √Äs vezes posso ser bastante duro e desagrad√°vel com minha fam√≠lia. |
| 10 | Me gusta ser el centro de atenci√≥n. | Gosto de ser o centro das aten√ß√µes. |
| 11 | De adolescente tuve muchos problemas por mi mal comportamiento en la escuela o instituto. | Na adolesc√™ncia, tive muitos problemas por mau comportamento na escola. |
| 12 | Me da miedo hacerme muy amigo de alguien porque podr√≠a acabar sinti√©ndome ridiculizado o avergonzado. | Tenho medo de me tornar muito amigo de algu√©m porque poderia acabar me sentindo ridicularizado ou envergonhado. |
| 13 | Noto que la gente est√° hablando de m√≠ cuando paso a su lado. | Percebo que as pessoas est√£o falando de mim quando passo ao lado delas. |
| 14 | Hace unos a√±os comenc√© a sentirme un fracasado. | H√° alguns anos comecei a me sentir um fracassado. |
| 15 | Si puedo elegir, prefiero hacer las cosas solo. | Se posso escolher, prefiro fazer as coisas sozinho. |
| 16 | √öltimamente he comenzado a sentir deseos de destrozar cosas. | Ultimamente comecei a sentir vontade de destruir coisas. |
| 17 | Las cosas que hoy van bien no durar√°n mucho tiempo. | As coisas que v√£o bem hoje n√£o v√£o durar muito tempo. |
| 18 | A veces, cuando las cosas empiezan a irme mal, me siento como si estuviera loco o fuera de la realidad. | √Äs vezes, quando as coisas come√ßam a dar errado, sinto como se estivesse louco ou fora da realidade. |
| 19 | Hago lo que quiero sin preocuparme de las consecuencias que tenga en los dem√°s. | Fa√ßo o que quero sem me preocupar com as consequ√™ncias para os outros. |
| 20 | Afronto mis actividades diarias con mucha energ√≠a y persistencia. | Enfrento minhas atividades di√°rias com muita energia e persist√™ncia. |

*Nota: Tradu√ß√£o completa dos 195 itens ser√° fornecida em arquivo separado.*

---

## ‚úÖ LISTA DE TAREFAS DE IMPLEMENTA√á√ÉO

### Fase 1: Prepara√ß√£o dos Dados (3-5 dias)

- [ ] **1.1** Traduzir todos os 195 itens para portugu√™s BR
- [ ] **1.2** Traduzir nomes de todas as escalas e facetas
- [ ] **1.3** Traduzir textos interpretativos para cada escala
- [ ] **1.4** Extrair tabelas de convers√£o completas dos arquivos Excel:
  - [ ] PD ‚Üí BR para todas as 25+ escalas
  - [ ] BR ‚Üí Percentil para todas as escalas
  - [ ] PD ‚Üí Percentil para facetas Grossman
- [ ] **1.5** Documentar todas as f√≥rmulas de c√°lculo (158 f√≥rmulas)
- [ ] **1.6** Criar arquivo JSON com estrutura completa do teste

### Fase 2: Banco de Dados (2-3 dias)

- [ ] **2.1** Criar migration para campos adicionais em `testes_templates`
- [ ] **2.2** Estruturar JSON de quest√µes com pesos
- [ ] **2.3** Estruturar JSON de regras de c√°lculo com f√≥rmulas
- [ ] **2.4** Estruturar JSON de tabelas de convers√£o
- [ ] **2.5** Criar script de seed para inserir MCMI-IV completo
- [ ] **2.6** Testar integridade dos dados

### Fase 3: Backend - C√°lculo e L√≥gica (5-7 dias)

- [ ] **3.1** Implementar fun√ß√£o `calcularInvalidez()`
- [ ] **3.2** Implementar fun√ß√£o `calcularInconsistencia()`
- [ ] **3.3** Implementar fun√ß√£o `calcularEscalasValidade()`
- [ ] **3.4** Implementar fun√ß√£o `calcularEscalasPersonalidade()`
- [ ] **3.5** Implementar fun√ß√£o `calcularPatologiasGraves()`
- [ ] **3.6** Implementar fun√ß√£o `calcularSindromesClinicas()`
- [ ] **3.7** Implementar fun√ß√£o `calcularFacetasGrossman()`
- [ ] **3.8** Implementar fun√ß√£o `calcularRespostasSignificativas()`
- [ ] **3.9** Implementar fun√ß√£o `converterPDparaBR()`
- [ ] **3.10** Implementar fun√ß√£o `converterBRparaPercentil()`
- [ ] **3.11** Implementar fun√ß√£o `gerarInterpretacao()`
- [ ] **3.12** Criar endpoint `/api/testes-aplicados/[id]/calcular`
- [ ] **3.13** Criar testes unit√°rios para cada fun√ß√£o de c√°lculo
- [ ] **3.14** Validar resultados contra Excel original

### Fase 4: Frontend - Aplica√ß√£o (3-4 dias)

- [ ] **4.1** Criar componente `MCMIQuestionRenderer`
- [ ] **4.2** Adaptar p√°gina de aplica√ß√£o para 195 itens V/F
- [ ] **4.3** Implementar navega√ß√£o otimizada (195 quest√µes)
- [ ] **4.4** Implementar salvamento progressivo
- [ ] **4.5** Adicionar valida√ß√£o de completude
- [ ] **4.6** Testar em diferentes dispositivos

### Fase 5: Frontend - Visualiza√ß√µes (4-5 dias)

- [ ] **5.1** Criar componente `<ValidityScales />`
- [ ] **5.2** Criar componente `<PersonalityProfileChart />`
  - [ ] Barras horizontais
  - [ ] Zonas de cor
  - [ ] Linhas de refer√™ncia
- [ ] **5.3** Criar componente `<GrossmanFacetsChart />`
- [ ] **5.4** Criar componente `<ClinicalSyndromesDisplay />`
- [ ] **5.5** Criar componente `<SignificantResponsesBadges />`
- [ ] **5.6** Criar componente `<InterpretationReport />`
- [ ] **5.7** Criar p√°gina de resultados MCMI-IV
- [ ] **5.8** Testar responsividade de todos os gr√°ficos

### Fase 6: Exporta√ß√£o PDF (2-3 dias)

- [ ] **6.1** Criar template de relat√≥rio MCMI-IV
- [ ] **6.2** Incluir gr√°ficos no PDF
- [ ] **6.3** Incluir interpreta√ß√£o textual completa
- [ ] **6.4** Testar gera√ß√£o de PDF

### Fase 7: Testes e Valida√ß√£o (3-4 dias)

- [ ] **7.1** Aplicar teste completo com caso real
- [ ] **7.2** Comparar resultados com Excel original
- [ ] **7.3** Validar todas as f√≥rmulas
- [ ] **7.4** Validar todas as convers√µes PD ‚Üí BR ‚Üí Percentil
- [ ] **7.5** Validar interpreta√ß√µes autom√°ticas
- [ ] **7.6** Corrigir diverg√™ncias
- [ ] **7.7** Testes de aceita√ß√£o com psic√≥logos

### Fase 8: Documenta√ß√£o (1-2 dias)

- [ ] **8.1** Documentar uso do MCMI-IV no sistema
- [ ] **8.2** Criar manual de interpreta√ß√£o
- [ ] **8.3** Documentar f√≥rmulas de c√°lculo
- [ ] **8.4** Criar FAQ sobre o teste

---

## üéØ RESUMO EXECUTIVO

### O que √© o MCMI-IV?

O **Invent√°rio Cl√≠nico Multiaxial de Millon - Quarta Edi√ß√£o (MCMI-IV)** √© um instrumento de avalia√ß√£o psicol√≥gica amplamente utilizado para:

- Avaliar padr√µes de personalidade
- Identificar patologias graves de personalidade
- Detectar s√≠ndromes cl√≠nicas ativas
- Fornecer informa√ß√µes para diagn√≥stico cl√≠nico multiaxial

### Caracter√≠sticas Principais

- **195 itens** de resposta Verdadeiro/Falso
- **64 escalas** de avalia√ß√£o (5 validade + 59 cl√≠nicas)
- **Sistema de pontua√ß√£o complexo** com pesos diferenciados
- **Interpreta√ß√£o automatizada** baseada em faixas normativas
- **Facetas detalhadas** (Grossman) para aprofundar an√°lise
- **Respostas significativas** para alertas cl√≠nicos espec√≠ficos

### Valor Para o Sistema NeuroTest

‚úÖ **Teste Premium**: MCMI-IV √© um dos testes mais completos e respeitados
‚úÖ **Diferencial Competitivo**: Poucos sistemas automatizam completamente
‚úÖ **Economia de Tempo**: C√°lculo manual leva 30-45 minutos, automatizado √© instant√¢neo
‚úÖ **Precis√£o Garantida**: Elimina erros de c√°lculo manual
‚úÖ **Visualiza√ß√µes Profissionais**: Gr√°ficos facilitam interpreta√ß√£o
‚úÖ **Relat√≥rios Completos**: PDF pronto para uso cl√≠nico

### Complexidade de Implementa√ß√£o

**Alta** - Este √© um dos testes mais complexos a serem automatizados devido a:
- 158 f√≥rmulas de c√°lculo diferentes
- Tabelas de convers√£o extensas (PD ‚Üí BR ‚Üí Percentil)
- 64 escalas interdependentes
- M√∫ltiplos n√≠veis de interpreta√ß√£o
- Facetas e sub-escalas

**Estimativa de Tempo Total**: 25-35 dias √∫teis (1-1.5 meses)

### Retorno do Investimento

- Permite cobrar pre√ßo premium por teste automatizado
- Atrai psic√≥logos especializados em avalia√ß√£o de personalidade
- Diferencial competitivo significativo
- Base para adicionar outros testes Millon (MACI, MBMD, etc.)

---

## üìö REFER√äNCIAS

- Millon, T., Grossman, S., & Millon, C. (2015). Millon Clinical Multiaxial Inventory-IV (MCMI-IV). Pearson.
- Grossman, S. D., & Amendolace, B. (2017). Essentials of MCMI-IV Assessment. Wiley.
- Arquivo Excel Original: `704531450-libre-MCMI-IV-Inventario-Cl√≠nico-Multiaxial-de-Millon-xlsx-sin-contra-1.xlsx`

---

**Documento Criado**: 21 de Outubro de 2024
**√öltima Atualiza√ß√£o**: 21 de Outubro de 2024
**Vers√£o**: 1.0
**Status**: Planejamento Completo - Aguardando Aprova√ß√£o para Implementa√ß√£o
